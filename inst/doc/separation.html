<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Ioannis Kosmidis" />

<meta name="date" content="2017-05-16" />

<title>Detecting separation and infinite estimates in binomial response GLMs</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Detecting separation and infinite estimates in binomial response GLMs</h1>
<h4 class="author"><em><a href="http://www.ucl.ac.uk/~ucakiko/">Ioannis Kosmidis</a></em></h4>
<h4 class="date"><em>16 May 2017</em></h4>



<section id="the-brglm2-package" class="level1">
<h1>The <strong>brglm2</strong> package</h1>
<p>Along with methods for improving the estimation of generalized linear models (see <a href="https://cran.r-project.org/package=brglm2/brglm2.pdf"><code>iteration</code></a> vignette), <a href="https://github.com/ikosmidis/brglm2"><strong>brglm2</strong></a> provides <em>pre-fit</em> and <em>post-fit</em> methods for the detection of separation and of infinite maximum likelihood estimates in binomial response generalized linear models.</p>
<p>The key methods are <code>detect_separation</code> and <code>check_infinite_estimates</code> and this vignettes describes their use.</p>
</section>
<section id="checking-for-infinite-estimates" class="level1">
<h1>Checking for infinite estimates</h1>
<p><span class="citation" data-cites="heinze:02">Heinze and Schemper (2002)</span> used a logistic regression model to analyse data from a study on endometrial cancer. <span class="citation" data-cites="agresti:15">Agresti (2015, Section 5.7)</span> provide details on the data set. Below, we fit a probit regression model with the same linear predictor as the logistic regression model in <span class="citation" data-cites="heinze:02">Heinze and Schemper (2002)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;brglm2&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">data</span>(<span class="st">&quot;endometrial&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;brglm2&quot;</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">modML &lt;-<span class="st"> </span><span class="kw">glm</span>(HG <span class="op">~</span><span class="st"> </span>NV <span class="op">+</span><span class="st"> </span>PI <span class="op">+</span><span class="st"> </span>EH, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;probit&quot;</span>), <span class="dt">data =</span> endometrial)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">theta_mle &lt;-<span class="st"> </span><span class="kw">coef</span>(modML)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">summary</span>(modML)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = HG ~ NV + PI + EH, family = binomial(&quot;probit&quot;), 
##     data = endometrial)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.47007  -0.67917  -0.32978   0.00008   2.74898  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   2.18093    0.85732   2.544 0.010963 *  
## NV            5.80468  402.23641   0.014 0.988486    
## PI           -0.01886    0.02360  -0.799 0.424066    
## EH           -1.52576    0.43308  -3.523 0.000427 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 104.90  on 78  degrees of freedom
## Residual deviance:  56.47  on 75  degrees of freedom
## AIC: 64.47
## 
## Number of Fisher Scoring iterations: 17</code></pre>
<p>As is the case for the logistic regression in <span class="citation" data-cites="heinze:02">Heinze and Schemper (2002)</span>, the maximum likelihood (ML) estimate of the parameter for <code>NV</code> is actually infinite. The reported, apparently finite value is merely due to false convergence of the iterative estimation procedure. The same is true for the estimated standard error, and, hence the value <code>r round(coef(summary(modML))[&quot;NV&quot;, &quot;z value&quot;], 3)</code> for the <span class="math inline">\(z\)</span>-statistic cannot be trusted for inference on the size of the effect for <code>NV</code>.</p>
<p>‘<span class="citation" data-cites="lesaffre:89">Lesaffre and Albert (1989, Section 4)</span> describe a procedure that can hint on the occurrence of infinite estimates. In particular, the model is successively refitted, by increasing the maximum number of allowed IWLS iterations at east step. At east step the estimated asymptotic standard errors are divided to the corresponding ones from the first fit. If the sequence of ratios diverges, then the maximum likelihood estimate of the corresponding parameter is minus or plus infinity. The following code chunk applies this process to <code>modML</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">check_infinite_estimates</span>(modML)</a></code></pre></div>
<pre><code>##       (Intercept)           NV       PI       EH
##  [1,]    1.000000 1.000000e+00 1.000000 1.000000
##  [2,]    1.320822 1.710954e+00 1.352585 1.523591
##  [3,]    1.410578 5.468665e+00 1.483265 1.617198
##  [4,]    1.413505 3.225927e+01 1.490753 1.618462
##  [5,]    1.413559 3.311464e+02 1.490923 1.618484
##  [6,]    1.413560 5.786011e+03 1.490924 1.618484
##  [7,]    1.413560 1.704229e+05 1.490924 1.618484
##  [8,]    1.413560 3.232598e+06 1.490924 1.618484
##  [9,]    1.413560 5.402789e+06 1.490924 1.618484
## [10,]    1.413560 9.295902e+06 1.490924 1.618484
## [11,]    1.413560 2.290248e+07 1.490924 1.618484
## [12,]    1.413560 3.953686e+07 1.490924 1.618484
## [13,]    1.413560 3.953686e+07 1.490924 1.618484
## [14,]    1.413560 3.953686e+07 1.490924 1.618484
## [15,]    1.413560 3.953686e+07 1.490924 1.618484
## [16,]    1.413560 3.953686e+07 1.490924 1.618484
## [17,]    1.413560 3.953686e+07 1.490924 1.618484
## [18,]    1.413560 3.953686e+07 1.490924 1.618484
## [19,]    1.413560 3.953686e+07 1.490924 1.618484
## [20,]    1.413560 3.953686e+07 1.490924 1.618484</code></pre>
<p>Clearly, the ratios of estimated standard errors diverge for <code>NV</code>.</p>
</section>
<section id="detecting-separation" class="level1">
<h1>Detecting separation</h1>
<p><code>detect_separation</code> tests for the occurrence of complete or quasi-complete separation in datasets for binomial response generalized linear models, and finds which of the parameters will have infinite maximum likelihood estimates. <code>detect_separation</code> relies on the linear programming methods developed in <span class="citation" data-cites="konis:07">Konis (2007)</span>.</p>
<p><code>detect_separation</code> is <em>pre-fit</em> method, in the sense that it does not need to estimate the model to detect separation and/or identify infinite estimates. For example</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">endometrial_sep &lt;-<span class="st"> </span><span class="kw">glm</span>(HG <span class="op">~</span><span class="st"> </span>NV <span class="op">+</span><span class="st"> </span>PI <span class="op">+</span><span class="st"> </span>EH, <span class="dt">data =</span> endometrial,</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">                       <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>),</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                       <span class="dt">method =</span> <span class="st">&quot;detect_separation&quot;</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">endometrial_sep</a></code></pre></div>
<pre><code>## Separation: TRUE 
## Existence of maximum likelihood estimates
## (Intercept)          NV          PI          EH 
##           0         Inf           0           0 
## 0: finite value, Inf: infinity, -Inf: -infinity</code></pre>
<p>The <code>detect_separation</code> method reports that there is separation in the data, that the estimates for <code>(Intercept)</code>, <code>PI</code> and <code>EH</code> are finite (coded 0), and that the estimate for <code>NV</code> is plus infinity. So, the actual maximum likelihood estimates are</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">coef</span>(modML) <span class="op">+</span><span class="st"> </span>endometrial_sep<span class="op">$</span>betas</a></code></pre></div>
<pre><code>## (Intercept)          NV          PI          EH 
##  2.18092821         Inf -0.01886444 -1.52576146</code></pre>
<p>and the estimated standard errors are</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">coef</span>(<span class="kw">summary</span>(modML))[, <span class="st">&quot;Std. Error&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">abs</span>(endometrial_sep<span class="op">$</span>betas)</a></code></pre></div>
<pre><code>## (Intercept)          NV          PI          EH 
##  0.85732428         Inf  0.02359861  0.43307925</code></pre>
</section>
<section id="citation" class="level1">
<h1>Citation</h1>
<p>If you found this vignette or <strong>brglm2</strong> in general useful, please consider citing <strong>brglm2</strong> using</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">citation</span>(<span class="st">&quot;brglm2&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in citation(&quot;brglm2&quot;): no date field in DESCRIPTION file of package
## 'brglm2'</code></pre>
<pre><code>## Warning in citation(&quot;brglm2&quot;): could not determine year for 'brglm2' from
## package DESCRIPTION file</code></pre>
<pre><code>## 
## To cite package 'brglm2' in publications use:
## 
##   Ioannis Kosmidis (NA). brglm2: Bias Reduction in Generalized
##   Linear Models. R package version 0.1.7.
##   https://github.com/ikosmidis/brglm2
## 
## A BibTeX entry for LaTeX users is
## 
##   @Manual{,
##     title = {brglm2: Bias Reduction in Generalized Linear Models},
##     author = {Ioannis Kosmidis},
##     note = {R package version 0.1.7},
##     url = {https://github.com/ikosmidis/brglm2},
##   }</code></pre>
</section>
<section id="references" class="level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-agresti:15">
<p>Agresti, A. 2015. <em>Foundations of Linear and Generalized Linear Models</em>. Wiley Series in Probability and Statistics. Wiley.</p>
</div>
<div id="ref-heinze:02">
<p>Heinze, G., and M. Schemper. 2002. “A Solution to the Problem of Separation in Logistic Regression.” <em>Statistics in Medicine</em> 21:2409–19.</p>
</div>
<div id="ref-konis:07">
<p>Konis, Kjell. 2007. “Linear Programming Algorithms for Detecting Separated Data in Binary Logistic Regression Models.” DPhil, University of Oxford. <a href="https://ora.ox.ac.uk/objects/uuid:8f9ee0d0-d78e-4101-9ab4-f9cbceed2a2a" class="uri">https://ora.ox.ac.uk/objects/uuid:8f9ee0d0-d78e-4101-9ab4-f9cbceed2a2a</a>.</p>
</div>
<div id="ref-lesaffre:89">
<p>Lesaffre, E., and A. Albert. 1989. “Partial Separation in Logistic Discrimination.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> 51 (1). [Royal Statistical Society, Wiley]:109–16. <a href="http://www.jstor.org/stable/2345845" class="uri">http://www.jstor.org/stable/2345845</a>.</p>
</div>
</div>
</section>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
